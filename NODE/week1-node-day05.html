<html>
<head>
  <title>week1-node-day05</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/307027 (zh-CN, DDL); Windows/6.1.0 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="686"/>
<h1>week1-node-day05</h1>

<div>
<span><div>学习目标</div><div>    完成豆瓣API中的电影top250后台项目制作<br/></div><div><br/></div><div>  1、简化--模块化路由---routes/index.js</div><div><img src="week1-node-day05_files/Image.png" type="image/png" data-filename="Image.png" width="383"/></div><div>2、编写了模块，这几个模块是类似的</div><div><img src="week1-node-day05_files/Image [1].png" type="image/png" data-filename="Image.png" width="431"/><img src="week1-node-day05_files/Image [2].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>3、添加导演的数据</div><div><a href="http://adminlte.la998.com/pages/tables/simple.html">http://adminlte.la998.com/pages/tables/simple.html</a>中选择一个表格模板，拿到源代码，将其放入dieectors.ejs</div><div>4、连接数据库操作</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>cnpm i async mongodb@2 -D</div><div><br/></div></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">var async = require('async');</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">var { MongoClient } = require('mongodb');</span></div><div><br style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"/></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">var mongourl = &quot;</span><a href="mongodb://localhost:27017/bk1803" style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">mongodb://localhost:27017/bk1803</a><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">&quot;;</span></div><div><br style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"/></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">module.exports = {</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">    defaultRoute: ( req, res, next ) =&gt; {</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">        async.waterfall( [</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">            ( cb ) =&gt; {</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">                MongoClient.connect( mongourl, ( err, db ) =&gt; {</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">                    if ( err ) throw err;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">                    cb( null, db );</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">                })</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">            },</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">            ( db, cb ) =&gt; {</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">                db.collection('casts').find( {}, {} ).toArray( ( err, res ) =&gt; {</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">                    if ( err ) throw err;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">                    cb( null, res );</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">                })</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">            }</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">        ], ( err, result ) =&gt; {</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">            var len = result.length;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">            res.render('casts', {</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">                result,</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">                len</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">            });</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">        })</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">        </span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">        </span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">    </span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">    }</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">}</span></div><div><br style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"/></div></div><div><br/></div><div><br/></div><div>5、添加分页功能</div><div><span>    编辑页面</span><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">&lt;div class=&quot;pull-right&quot;&gt;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">                        &lt;button class = &quot;btn btn-xs btn-default&quot; &gt;首页&lt;/button&gt;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">                        &lt;button class = &quot;btn btn-xs btn-default&quot; &gt;上一页&lt;/button&gt;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">                        &lt;input type=&quot;text&quot; id=&quot;currentNum&quot; value=&quot;1&quot; /&gt;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">                        /</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">                        &lt;input type=&quot;text&quot; disabled value=&quot;12&quot;/&gt;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">                        &lt;button class = &quot;btn btn-xs btn-default&quot; &gt;下一页&lt;/button&gt;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">                        &lt;button class = &quot;btn btn-xs btn-default&quot;&gt;尾页&lt;/button&gt;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">                        每页显示&lt;select &gt;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">                             &lt;option value = &quot;5&quot; selected&gt;5&lt;/option&gt;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">                             &lt;option value = &quot;10&quot;&gt;10&lt;/option&gt;</span><span style="font-family: Monaco; font-size: 9pt;">     &lt;/select&gt;个</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">                    &lt;/div&gt;</span></div></div><div><br/></div><div>配置分页路由，routes/index.js   routes/casts.js</div><div>index.js</div><div><img src="week1-node-day05_files/Image [3].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>casts.js</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">var url = require('url');</span></div><div><br style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"/></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">var async = require('async');</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">var { MongoClient } = require('mongodb');</span></div><div><br style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"/></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">var mongourl = &quot;</span><a href="mongodb://localhost:27017/bk1803" style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">mongodb://localhost:27017/bk1803</a><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">&quot;;</span></div><div><br style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"/></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">module.exports = {</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">    defaultRoute: ( req, res, next ) =&gt; {</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">        async.waterfall( [</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">            ( cb ) =&gt; {</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">                MongoClient.connect( mongourl, ( err, db ) =&gt; {</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">                    if ( err ) throw err;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">                    cb( null, db );</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">                })</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">            },</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">            ( db, cb ) =&gt; {</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">                db.collection('casts').find( {}, {} ).toArray( ( err, res ) =&gt; {</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">                    if ( err ) throw err;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">                    cb( null, res );</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">                    db.close();</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">                })</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">            }</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">        ], ( err, result ) =&gt; {</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">            var len = result.length;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">            res.render('casts', {</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">                result,</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">                len</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">            });</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">        })</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">    },</span></div><div><span style="font-family: Monaco;"><font style="font-size: 14pt;"><font color="#E30000">//分页路由</font><br/></font></span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">    pagingRoute: ( req, res, next) =&gt; {</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">        var { limitNum, skipNum } = url.parse( req.url, true ).query;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">        limitNum = limitNum * 1 || 5;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">        skipNum = skipNum * 1 || 0;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">        async.waterfall( [</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">            ( cb ) =&gt; {</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">                MongoClient.connect( mongourl, ( err, db ) =&gt; {</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">                    if ( err ) throw err;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">                    cb( null, db );</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">                })</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">            },</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">            ( db, cb ) =&gt; {</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">                //mongodb 处理分页</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">//                 db.collection('casts').find( {}, {} ).limit( limitNum ).skip( limitNum * skipNum ).toArray( ( err, res ) =&gt; {</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">//                     if ( err ) throw err;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">//                     cb( null, res );</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">//                     db.close();</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">//                 })</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">               </span><span style="font-family: Monaco; font-size: 9pt;"><font color="#8600A4"> //js处理分页  - --  </font></span></div><div><span style="font-family: Monaco; font-size: 9pt;"><font color="#8600A4">                //拿到全部的数据，res</font></span></div><div><span style="font-family: Monaco; font-size: 9pt;"><font color="#8600A4">                //求得全部数据的长度 listLen</font></span></div><div><span style="font-family: Monaco; font-size: 9pt;"><font color="#8600A4">                //截取当前页面的数据 data     res.splice()   ----  返回的是截取的数据</font></span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">                db.collection('casts').find( {}, {} ).toArray( ( err, res ) =&gt; {</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">                    if ( err ) throw err;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">                    var listLen = res.length;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">                 </span><span style="font-family: Monaco; font-size: 9pt;"><font color="#9C004C">   //从哪开始截取，截取多少个，对应的是mongodb中的limit()和skip()</font></span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">                    var data = res.splice( limitNum * skipNum,  limitNum );</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">                    </span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">                    cb( null, {</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">                        listLen,</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">                        data</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">                    })</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">                    db.close();</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">                })</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">            }</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">        ], ( err, result ) =&gt; {</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">            /**</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">             * var { listLen, data } = result;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">             listLen代表其这个数据库集合中所有数据的个数</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">             data:当前页面所对应的数据列表</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">             */</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">            var len = result.data.length; // 前端循环遍历数据的条件</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">            var totalNum = Math.ceil( result.listLen / limitNum ); //总共有多少页数据</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">            skipNum = skipNum + 1;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">            res.render('casts', {</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">                result: result.data,</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">                len,</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">                totalNum,</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">                skipNum,</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">                limitNum</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">            });</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">        })</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">    }</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">}</span></div><div><br style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"/></div></div><div><br/></div><div><span>    給前端分页部分添加路由</span><br/></div><div>分页----首页功能</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">&lt;button class = &quot;btn btn-xs btn-default&quot; onclick = &quot;goFirstPage(&lt;%= limitNum %&gt;)&quot;&gt;首页&lt;/button&gt;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">function goFirstPage(limitNum ){</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">            window.location.href = '/castspaging?limitNum='+limitNum+'&amp;skipNum=0';</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">        }</span></div></div><div>分页---尾页<br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">&lt;button class = &quot;btn btn-xs btn-default&quot; onclick = &quot;goLastPage(&lt;%= totalNum %&gt;, &lt;%= limitNum %&gt;)&quot;&gt;尾页&lt;/button&gt;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">function goLastPage ( totalNum, limitNum  ) {</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">            // var limitNum = $(&quot;#limitNum&quot;).val();</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">            var skipNum = totalNum - 1;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">            window.location.href = '/castspaging?limitNum='+limitNum+'&amp;skipNum=' + skipNum;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">        }</span></div></div><div>分页---当前页</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">&lt;input type=&quot;text&quot; id=&quot;currentNum&quot; value=&quot;&lt;%= skipNum %&gt;&quot; onchange=&quot;goPage(&lt;%= totalNum %&gt;, &lt;%= limitNum %&gt;)&quot;/&gt;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">function goPage ( totalNum, limitNum  ) {</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">            var val = $(&quot;#currentNum&quot;).val();</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">            // var limitNum = $(&quot;#limitNum&quot;).val();</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">            </span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">            // alert(totalNum)</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">            var skipNum = val - 1;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">            if ( val &gt;= totalNum) {</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">                $(&quot;#currentNum&quot;).val( totalNum );</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">                skipNum = totalNum - 1;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">            }else if ( val &lt;= 1) {</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">                $(&quot;#currentNum&quot;).val( 1 );</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">                skipNum = 0;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">            }</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">            window.location.href = '/castspaging?limitNum='+limitNum+'&amp;skipNum=' + skipNum;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">        }</span></div></div><div>分页--上一页</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">&lt;button class = &quot;btn btn-xs btn-default&quot; onclick = &quot;goPrevPage(&lt;%= skipNum %&gt;, &lt;%= limitNum %&gt;)&quot;&gt;上一页&lt;/button&gt;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">function goPrevPage ( skipNum, limitNum  ) {</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">            // var limitNum = $(&quot;#limitNum&quot;).val();</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">            // alert(skipNum)</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">            var skipNum = skipNum;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">            if ( skipNum == 1) {</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">                $(&quot;#currentNum&quot;).val( 1 );</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">                skipNum = 0;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">            }else {</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">                skipNum -= 2;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">            }</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">            window.location.href = '/castspaging?limitNum='+limitNum+'&amp;skipNum=' + skipNum;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">        }</span></div></div><div><br/></div><div>分页---下一页</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">&lt;button class = &quot;btn btn-xs btn-default&quot; onclick = &quot;goNextPage(&lt;%= skipNum %&gt;, &lt;%= totalNum %&gt;, &lt;%= limitNum %&gt;)&quot;&gt;下一页&lt;/button&gt;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">function goNextPage ( skipNum, totalNum, limitNum ) {</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">            // var limitNum = $(&quot;#limitNum&quot;).val();</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">            var skipNum = skipNum;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">            if ( skipNum == totalNum) {</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">                $(&quot;#currentNum&quot;).val( totalNum );</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">                skipNum = totalNum - 1;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">            }</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">            // alert(skipNum)</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">            window.location.href = '/castspaging?limitNum='+limitNum+'&amp;skipNum=' + skipNum;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">        }</span></div></div><div><br/></div><div>分页---选择每页个数</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">每页显示&lt;select onchange = &quot;changeLimit(&lt;%= limitNum %&gt;)&quot; id = &quot;limitNum&quot;&gt;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">                        &lt;% if( limitNum  == 5) { %&gt;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">                             &lt;option value = &quot;5&quot; selected&gt;5&lt;/option&gt;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">                             &lt;option value = &quot;10&quot;&gt;10&lt;/option&gt;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">                        &lt;% }else if ( limitNum == 10) {  %&gt;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">                             &lt;option value = &quot;5&quot; &gt;5&lt;/option&gt;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">                             &lt;option value = &quot;10&quot; selected&gt;10&lt;/option&gt;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">                        &lt;% }  %&gt;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">                                        &lt;/select&gt;个</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"><br/></span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"><br/></span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">function changeLimit ( limitNum ) {</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">            // alert( limitNum )</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">            // alert( $(&quot;#limitNum&quot;).val() )</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">            var limitNum = $(&quot;#limitNum&quot;).val();</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">            </span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">            window.location.href = '/castspaging?limitNum='+limitNum+'&amp;skipNum=0';</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">        }</span></div></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div>解决别人图片不能显示问题：<a href="https://www.iteblog.com/archives/1929.html">https://www.iteblog.com/archives/1929.html</a></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">&lt;meta name=&quot;referrer&quot; content=&quot;no-referrer&quot;&gt;</span></div></div><div><br/></div><div>数组的常用方法以及应用场景（es6数组的新增方法）</div><div><br/></div><div><br/></div><div><br/></div></span>
</div></body></html> 